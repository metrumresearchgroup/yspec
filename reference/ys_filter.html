<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Subset yspec items using column values — ys_filter • yspec</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Subset yspec items using column values — ys_filter"><meta property="og:description" content="The intended use is to subset based on variables define in the dots list,
however some internal column data is also available to query."><meta property="og:image" content="https://metrumresearchgroup.github.io/yspec/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">yspec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/yspec.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/reference.html">Yaml specification reference</a>
    </li>
    <li>
      <a href="../articles/analysis1.html">Example yaml specification file</a>
    </li>
    <li>
      <a href="../articles/lookup.html">Project-wide column definitions</a>
    </li>
    <li>
      <a href="../articles/ysdb_internal.html">Internal Column Lookup Database</a>
    </li>
    <li>
      <a href="../articles/project.html">Project object and define document</a>
    </li>
    <li>
      <a href="../articles/label.html">Label the columns in a data set</a>
    </li>
    <li>
      <a href="../articles/extract.html">Extract data from a yspec object</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/metrumresearchgroup/yspec/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Subset yspec items using column values</h1>
    <small class="dont-index">Source: <a href="https://github.com/metrumresearchgroup/yspec/blob/0.6.3/R/ys-tidy.R" class="external-link"><code>R/ys-tidy.R</code></a></small>
    <div class="hidden name"><code>ys_filter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The intended use is to subset based on variables define in the <code>dots</code> list,
however some internal column data is also available to query.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ys_filter</span><span class="op">(</span><span class="va">x</span>, <span class="va">expr</span>, .default <span class="op">=</span> <span class="cn">NULL</span>, .enclos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A yspec object.</p></dd>


<dt id="arg-expr">expr<a class="anchor" aria-label="anchor" href="#arg-expr"></a></dt>
<dd><p>An unquoted expression.</p></dd>


<dt id="arg--default">.default<a class="anchor" aria-label="anchor" href="#arg--default"></a></dt>
<dd><p>A named list or environment containing defaults for <code>expr</code>;
consider using <code><a href="ys_fill_dots.html">ys_fill_dots()</a></code> as an alternative to passing <code>.default</code>.</p></dd>


<dt id="arg--enclos">.enclos<a class="anchor" aria-label="anchor" href="#arg--enclos"></a></dt>
<dd><p>An enclosing environment for evaluating <code>expr</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>yspec</code> object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The following fields always exist in the spec and are available for
querying in the filter expression:</p><ul><li><p><code>col</code>:  column name <code>&lt;character&gt;</code></p></li>
<li><p><code>type</code>: data type <code>&lt;character&gt;</code>; either numeric, character, or integer</p></li>
<li><p><code>discrete</code>: discrete data flag <code>&lt;logical&gt;</code>; yspec sets this to <code>TRUE</code>
when the <code>values</code> field is populated</p></li>
<li><p><code>continuous</code>: continuous data flag <code>&lt;logical&gt;</code>; yspec sets this to <code>TRUE</code>
when the <code>range</code> field is populated</p></li>
<li><p><code>short</code>: the short name <code>&lt;character&gt;</code></p></li>
<li><p><code>do_lookup</code>: lookup indicator; yspec sets this to <code>TRUE</code> when some or all
of the column data is defined by an external lookup file</p></li>
</ul><p>The following fields will be provided defaults when the filter expression
is evaluated:</p><ul><li><p><code>unit</code>: as specified by the user <code>&lt;character&gt;</code>; default value is  ""</p></li>
<li><p><code>covariate</code>: as specified by the user in <code>dots</code> <code>&lt;logical&gt;</code>; default value
is <code>FALSE</code></p></li>
</ul><p>In addition to these fields, you can build the filter expression using
items in the <code>dots</code> field.</p>
    </div>
    <div id="evaluation-environment">
    <h2>Evaluation environment</h2>


<p>In order to determine if any column should get selected, <code>ys_filter()</code>,
builds an environment and evaluates <code>expr</code> in that environment. Columns are
selected only if <code>expr</code> evaluates to <code>TRUE</code> (via <code><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE()</a></code>).</p>
<p>The environment is comprised of pre-existing data items in the spec (e.g.
<code>col</code> or <code>short</code>; these items are always present), data items in the enclosing
environment (<code>.enclos</code>; this defaults to <code><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame()</a></code>), the <code>.defaults</code>
list (passed by the user at run time) and the <code>.dots</code> list associated with
each column.</p>
<p>Users are encouraged to filter based on logical data items in <code>dots</code> that are
set through the <code>flags</code> field in <code>SETUP__</code>. When <code>flags</code> are set, every
column is given a logical data item that can always be evaluated for every
column. This is the safest and simplest way to go and should be the target
usage. In case more complicated applications are required, users can appeal
to data items in <code>dots</code> which may or may not be logical. Of course, the user
can enter data into <code>dots</code> for every column to ensure that data item is
available for evaluating <code>expr</code> but that might not be very convenient. In
that case, pass a list of <code>.defaults</code> that will be used when the filter
variable isn't available in <code>dots</code>. As an alternative to using <code>.defaults</code>,
the user can run the <code>spec</code> object through <code>ys_dots_fill</code> which will
fill in dots data items with default values only when they don't exist. This
is probably more convenient, but the user is warned that these data items
in <code>dots</code> stay with the <code>yspec</code> object for the life of the object.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ys_rename.html">ys_rename()</a></code>, <code><a href="ys_join.html">ys_join()</a></code>, <code><a href="ys_select.html">ys_select()</a></code>, <code><a href="ys_fill_dots.html">ys_fill_dots()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="va">ys_help</span><span class="op">$</span><span class="fu">spec</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ys_filter</span><span class="op">(</span><span class="va">spec</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">decode</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  name  info unit         short                         source       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  C     cd-  .            comment character             ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NUM   ---  .            record number                 ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ID    ---  .            subject identifier            ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  SUBJ  c--  .            subject identifier            ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  TIME  ---  hour         TIME                          look         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  SEQ   -d-  .            SEQ                           .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CMT   ---  .            compartment number            ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  EVID  -d-  .            event ID                      ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  AMT   ---  mg           dose amount                   ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  DV    ---  micrograms/L dependent variable            ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  AGE   ---  years        age                           ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  WT    ---  kg           weight                        ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CRCL  ---  ml/min       CRCL                          .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ALB   ---  g/dL         albumin                       ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  BMI   ---  m2/kg        BMI                           ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  AAG   ---  mg/dL        alpha-1-acid glycoprotein     .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  SCR   ---  mg/dL        serum creatinine              .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  AST   ---  .            aspartate aminotransferase    .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ALT   ---  .            alanine aminotransferase      .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  HT    ---  cm           height                        ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CP    -d-  .            Child-Pugh score              look         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  TAFD  ---  hours        time after first dose         .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  TAD   ---  hours        time after dose               .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  LDOS  ---  mg           last dose amount              .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MDV   -d-  .            MDV                           ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  BLQ   -d-  .            below limit of quantification .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PHASE ---  .            study phase indicator         .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  STUDY -d-  .            study number                  .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  RF    cd-  .            renal function stage          .            </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ys_filter</span><span class="op">(</span><span class="va">spec</span>, <span class="va">unit</span> <span class="op">==</span> <span class="st">"kg"</span> <span class="op">|</span> <span class="va">type</span> <span class="op">==</span> <span class="st">"character"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  name info unit short                source       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  C    cd-  .    comment character    ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  SUBJ c--  .    subject identifier   ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  WT   ---  kg   weight               ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  RF   cd-  .    renal function stage .            </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ys_filter</span><span class="op">(</span><span class="va">spec</span>, <span class="va">covariate</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  name info unit   short                      source       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  AGE  ---  years  age                        ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  WT   ---  kg     weight                     ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CRCL ---  ml/min CRCL                       .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ALB  ---  g/dL   albumin                    ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  BMI  ---  m2/kg  BMI                        ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  AAG  ---  mg/dL  alpha-1-acid glycoprotein  .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  SCR  ---  mg/dL  serum creatinine           .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  AST  ---  .      aspartate aminotransferase .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ALT  ---  .      alanine aminotransferase   .            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  HT   ---  cm     height                     ysdb_internal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CP   -d-  .      Child-Pugh score           look         </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kyle T Baron.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer></div>






  </body></html>

